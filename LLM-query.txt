# CRITICAL ISSUES SUMMARY - Next.js Navigation Problems

## URGENT PROBLEMS (Dec 24, 2025)

### 1. NAVIGATION MENU ORDER IS NOT CHANGING
**Problem**: Despite multiple attempts to reorder navigation items, the menu order remains unchanged on the live site.

**Expected Order**: EMSculpt Neo → Exion → EMFace → **Injectables** → EMSella → About
**Current Order**: EMSculpt Neo → Exion → EMFace → EMSella → **Injectables** → About

**Changes Made But Not Working**:
- Modified `/lib/constants.ts` NAVIGATION_ITEMS array
- Committed and pushed to multiple git remotes (origin, boris)
- Forced multiple redeployments
- Changes are present in the source code but NOT reflecting on live site

### 2. EMFACE DROPDOWN STILL MISALIGNED
**Problem**: EMFace dropdown appears centered instead of left-aligned under the "EMFace" menu item.

**Visual Evidence**: Dropdown shows centered on page with content: Eyes, Cheeks, Forehead, Jawline-Submentum sections.

## TECHNICAL ENVIRONMENT

**Framework**: Next.js 15.3.3 + Tailwind CSS 4.1.x + Radix UI + shadcn/ui  
**Live Site**: https://playground-m8q0n97sn-alberto-e69d8928.vercel.app  
**Repository**: Multiple remotes - deployment may be connected to wrong remote

## CURRENT SOURCE CODE

### Navigation Constants (`/lib/constants.ts`)
```typescript
export const NAVIGATION_ITEMS = [
  { href: "/emsculpt-neo", labelKey: "nav_emsculpt_neo" },
  { href: "/exion", labelKey: "nav_exion" },
  { href: "/emface", labelKey: "nav_emface" },
  { href: "/injectables", labelKey: "nav_injectables" }, // SHOULD BE HERE
  { href: "/emsella", labelKey: "nav_emsella" },        // SHOULD BE AFTER INJECTABLES
  { href: "/about", labelKey: "nav_about" },
] as const
```

### Navigation Component (`/components/navigation.tsx`)
```typescript
// Line 44 - Maps over NAVIGATION_ITEMS correctly
{NAVIGATION_ITEMS.map((item) => (
  <NavigationMenuItem key={item.href}>
    {item.labelKey === "nav_emsculpt_neo" ? (
      // EMSculpt Neo with dropdown
    ) : item.labelKey === "nav_emface" ? (
      // EMFace with dropdown - PROBLEMATIC SECTION
      <>
        <NavigationMenuTrigger>
          {t(item.labelKey)}
        </NavigationMenuTrigger>
        <NavigationMenuContent align="start" sideOffset={6} className="md:left-0" data-align="left">
          <div className="grid w-[400px] gap-3 p-4">
            {EMFACE_SUBMENU_ITEMS.map((subItem) => (
              // Menu items here
            ))}
          </div>
        </NavigationMenuContent>
      </>
    ) : (
      // Regular menu items
    )}
  </NavigationMenuItem>
))}
```

### Navigation Menu UI (`/components/ui/navigation-menu.tsx`)
```typescript
const NavigationMenuViewport = React.forwardRef<
  React.ElementRef<typeof NavigationMenuPrimitive.Viewport>,
  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Viewport>
>(({ className, ...props }, ref) => {
  return (
    <div
      className={cn(
        "absolute left-0 top-full flex justify-center md:w-auto", // CENTERING ISSUE
        className
      )}
      data-radix-navigation-menu-viewport
    >
      <NavigationMenuPrimitive.Viewport
        className={cn(
          "origin-top-center relative mt-1.5 h-[var(--radix-navigation-menu-viewport-height)] w-full overflow-hidden border bg-popover text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-90 md:w-[var(--radix-navigation-menu-viewport-width)]",
          className
        )}
        ref={ref}
        {...props}
      />
    </div>
  )
})
```

### CSS Fixes Attempted (`/app/globals.css`)
```css
/* Navigation Menu Fixes */
@layer components {
  /* Fix EMFace dropdown alignment - Force left alignment when EMFace is open */
  @media (min-width: 768px) {
    /* Target the viewport wrapper when left-aligned content is open */
    [data-radix-navigation-menu-viewport] {
      justify-content: flex-start !important;
      left: 0 !important;
      transform: none !important;
    }
    
    /* Ensure the content itself also aligns left */
    [data-align="left"] {
      left: 0 !important;
      right: auto !important;
    }
    
    /* Additional targeting for the specific EMFace dropdown case */
    [data-radix-navigation-menu-viewport]:has([data-align="left"]) {
      justify-content: flex-start !important;
      left: 0 !important;
      transform: none !important;
    }
  }
}
```

## GIT REPOSITORY STATUS

**Current Branch**: main  
**Remote Repositories**:
- origin: https://github.com/drpertusa/reshape-clinic-website.git
- boris: https://github.com/drpertusa/Reshape-prototype-for-Boris.git
- reshape: https://github.com/drpertusa/reshape-clinic-website.git
- upstream: https://github.com/drpertusa/reshape-prototype-01.git

**Issue**: Unclear which remote is connected to the live deployment. Changes pushed to multiple remotes but not appearing.

## FAILED ATTEMPTS

### Navigation Order:
1. ✅ Modified `NAVIGATION_ITEMS` in `/lib/constants.ts`
2. ✅ Committed changes: "Reorder navigation: move Injectables before EMSella"
3. ✅ Pushed to origin and boris remotes
4. ✅ Forced multiple redeployments
5. ❌ **RESULT**: No changes visible on live site

### EMFace Dropdown:
1. ✅ Added `align="start"` and `sideOffset={6}` to NavigationMenuContent
2. ✅ Modified CSS with multiple targeting approaches
3. ✅ Updated NavigationMenuViewport component
4. ✅ Added `data-align="left"` attribute
5. ❌ **RESULT**: Dropdown still centered

## QUESTIONS FOR INVESTIGATION

1. **Which git remote is actually connected to the live deployment?**
2. **Is there a build cache or deployment pipeline issue preventing updates?**
3. **Is the Radix UI NavigationMenu overriding our CSS with inline styles?**
4. **Are there multiple navigation components or the changes aren't being built correctly?**
5. **Is there client-side caching preventing navigation updates?**

## REQUEST FOR SOLUTION

Please investigate and provide:

1. **Navigation Order Fix**: Why the NAVIGATION_ITEMS changes aren't appearing and how to make the menu order change from "EMFace → EMSella → Injectables" to "EMFace → Injectables → EMSella"

2. **EMFace Dropdown Alignment**: A robust solution to left-align the EMFace dropdown under its trigger without affecting other dropdowns

3. **Deployment Diagnosis**: Help identify why changes aren't reaching the live site despite successful commits and pushes

**Constraints**: 
- Must work with existing Radix UI + Next.js setup
- Cannot break other dropdowns (EMSculpt Neo should remain centered)
- Must be responsive and work on desktop (≥768px)

**Priority**: URGENT - These are blocking issues for the live site.